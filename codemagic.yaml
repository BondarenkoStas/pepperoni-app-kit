workflows:
  react-native-workflow:
    name: react native workflow
    environment:
      vars:
        CM_KEYSTORE: Encrypted(Z0FBQUFBQmQyX2ZXVE15WUhvcHBVLXBiWU52MWVNakNVMUp5U2xtdE1aeXk4bVNvV3JobUM3RTItSEIyT0loTlVqNWU3ZEVXMTdaSWhab0c5YlZZYnJGOFdIWGd1NF8taFBMZHFsT0JmdnVpdFNHYy1UenV0WFNYLThaZkRpOUl4c2JiQnJZWHBSVVkwajkyQVdZc2RrUC1OSGFzU2pyNjdyd19QdzJvNlQydW5uVkV2cm9wRzdsY3YwYnJBRHVPWkZnTWZkUDJTOU9YZTFCeFdIZ25vMlk4YkFYSzl6YWtvNThBakZMVmgxT2FhTWlpcS1fU1FGOGh0TU5EV2ItOVV4XzAyQ1lBdUdnYzBfamlvMjdFM3g5blF2cThfZmVHSF84WE1Qd0VXRlA1b29QbmUwZG5ZbTZmVUhxR2x5TS1DTzBoalZCV0ZqYlEtLUtvTW0tZDctY2RjamtDVnYwZVJNOENiR1FheU96cXpfbzBZZWNGcy1yVGdMWlJFNUFoRXFRSFVmTUNwQ2trdnhTbG5RemFnTkR6V19RYURmY0VPV0RNemFad1B0N3NkRlJqNFdFUjJYZjk0cHhEYzRPMmlWRnpnb2MtRURQT3lqeXk0WkM3eFlvRkJQQU1ucHpGS3VpV3JnTTQ0ajRFNERRUUZmeko0eHZINFg2MlBCd0xZTGRmejhINjgzeWFtbGNDcVRVRk1HZHVXY1VqLWNvN3d4bG91ZW1wcU1lTTFzLWk2OURWZklDa3NXRWtlYjNGeW5jeUdPZGFnLTBOSUNDNndkZXZpdDJOX3c4VG83b3pMYURYWUlhcFNtM2E1YURsYzc2QjB6Q0NIM2NxVDRPMG45VjRMcWp4TlZ1eG13RGl4RXFmNHIyTjhMUjA3b0lwX3Q4aUx5Ym8tNWtTQzdMM2ZUVVBlVmVGMHZUemtIT0lueG9WSFRKdDY4dkRJVnF0UXJMOUFrVUswYUNhNGJiUWFaMVFfTXlnRk9TWC1zd3FPQWJhN1BGRnQ3b0FtQTlVQlBZV1hjcVlYaHcwSm01OUxtWVZTWWRLVDhCZ3hzeTJqXy1nQWJwR0VhYWUxSlIwdnZmeGd5elZoMm5KSlE5QUxHUjFOQjhuZVBVQlFlc3J0SFVmUzZQcXhHTjJ6MFhSQklkek5Mc1JJa0ZiSjgtTU5ldGxmWUxrOTB2cDQtYXRZcTBNMExjS3pHVUR0SGxJSlQwYTMwX1dySWNvSjVfUEpXYmJRc1VxZ3ZxNzZVQTRTeXE3TmQ0WjlyNXRXcC1NNmJPdk5POUZiODdMZ1JOSHNCalUzbGROVEw4RDZPMDJ6d1BsRE5HRzVXNlhsdVlGY3RfWUFwR2xoTnBqa01IRTRWWmozOHNVajF5aHdkdGFJeTBIQzhiUGNXMFNzcy05eFB6UnpLNWcwNnlST2JCZjN2Rnhzd3B3SlRHS3E4eXB2Rko4eDZ4bEczSWxpZU9keDBrTkxBV0FvUlVMMVJnekNsbTFLWlIyeWUzM0IwSzdLTmdEN2ZOTEF1ZVcxWGlvZHk3U1BzdGxTUFBZSkx3c2RzZ3gyX2pkX2JHT01CUUY3emxTWS11V3lmaG1JZlRuV25aVmZUVU1MS293Qy1JNzFxclk3SlBWNmJoMWRxWGRFcko4WldRQ2JOeU5XX01nMXcxQ2xxV2NPeUxVcXJtR2RHSzd6NFk5bkhyMU9XWEFOWTgtdS1HV1puWUEzb0VBb0Y5WldINHZWVlA0QXNSelRFWmJjeUh4cWZOZURUT0ZLeGRQRnR5aldramdkN3M0UXVpeVB2MXdNcWZqUjdKRTZsakFHZWRaT1RTVGFPZjlXYmdDb21HalhUZ21TRVhCVV9ZQ1ZaM1ZpOE5HUFlWUzJOVEU4QTFsaXh4bjNWMDUtZmNyY3lEbFRsRmtFTnBqSHlwUk9OMDRvcUxWXzByQUctaTEzTlJvSUN3NHBKNnZXU2J4Z1RXSVpGWGs2UlVwOUpud3hlWDd0cllSYTdfcVI2RjBtMlZ1WmJPYjhOeENfMzNxVnRrTDZJMVMzM2RYNHVrcG5uS0dBbXFtcmVDc3BCS3k0dGlBYVkwMUtlZ1UyanJPRDFuUHF2VXhLM0Y5V01pOHB3Rm9jTXlKaWZqY08zeUVrcEVTbkdXU01qUVNiZUY1YzVoMjJoM3Zqem5ybXpDOWF0c3JSQk9GaFJHT0RvS0MzUWg1YUY4N3k1emlYYnpfVUttYWt0MGRpbWprLVhJWi14Zi15TGVtMnQxTlEyVmNDdU4tOVlHbldQa1FmZXhRelBUV0ZycEs4Sm44dkd3OWdfN09vNXdyQVZWc0lHakNmV0w3SmRIaWlEUk1SQm9QczlMTy1LUXFlZllGMTlTT0NrQjg1LV9OcXA1MDhjMmN4WGRBc2otUkFucVNGN21QN1VwRDdrblctLXhzT0FtTlh1aUYyVnBpOGtxNUQ0Z2xCemdBd2N6Y28zZUE2TmhldzdzUmVWRWdpSkVYbmNkN3BzRHg5ZDQzLUlxOHlUMmNkbmZmRXRuZjBuaVdOUEVvdmxZanV2dE9NdFRVWG12a3JmY3UtVzJ0dHRjdzFnNHljSlRVdTVjRVJtQUxlN2VSQ0pmZkZZQ0FfNHFpcFhleTJyQVZsWHJTMFNVazFJeTRYVUFEeE80VkEtREpROVYxQmJHeUtETXFGV2hfTXBmMkxNbmg1cmt1NDBsZUtyMDZLMnJIbWhYZ3dKSnpfREVUX29RYWpOb2pvU3Yzc2F4NVotZHpqRm16YkxDZmJySi1oVTB6R1VEOFlDZGFtTnZ3dmY3dUpnSTk4czJCcmhGdzIxcmNOV0VLMl9idGFoQWhqRkhONnZJVEplbC1CSVBGMkVBekVpNklMbFpmUFI0T3gzVm8xYVowSk12WFlNMk1TZFd5YXVmRjZIVE40SEt3aC1iak9UMnk1TUl2WG11ekQ3SHRyYW9weUdsY2FrNUoyZncwOElIckpJREFtS1dydDhEX2dyMkhJSXA1a1FraEZKRUlSNkU0Vk9DaXduTEwtdDV5eWlXR09aRGQ2X0ZDTTNiVFA4SGtDcUtSTWdYa1paNFJRQjM1V3N4N2VvMjRKXzltOXZ6d1JFamRNUWRaY2RkV2h0eTJHRUNnREJqNFUxbTBvbnNUUnhnUC1vX0FEZV9NWmNEQkJ2UWxVVEZDcmdjZFNzQXBzMHV0U1FRUDlFMWplbmNTd0U4Xy1ueFpPN0dOV1hiMG1PbE5tTjhESm5fUEJGVWxvbWNQVjRyWDFUenpRRFFwWlJhdkJrY3dHcHVaanZucTdFZzA1dnZ4YUZTZV9aU2NCRk5kMVUyaFJfeVF6T0pmdWhzQnM0ZGppVFJXV1dCRko3Uzd5RlJEbG4tbk1lVmVFVW5jSjF1R1ZIUVd3VXg0YVpKdXFha205V3gtNnlkYzVGYWRmeWxaOG92UmYtc1BVNl9YX25mbk1yTHQ0Wk5NN2tVaXRtZ3pJR1JyQXNsRUp4STBPcHdmMWFySll6MmRDekp0YlpWbUsxV1RmcE1lNkExU3lfZzlYa0FGVnZxZzBkSE95VnZlOGR1WjN1YmF0SHQ5Q3hibUpqd0pDX2REM3h2NGhnU2RsNXloUlJQNURUYmdJQVNKOFJISzZuempFbE9qZF9tcGFZb0ozM3NvZUt1ZElrNzR3RFFtNkk5ZWFMd3dlZnBXemE2SDFqeVlXR3doM21yTzFfcEV3UnowNUI2bzV3WGVmT1hLcE1nR0IteEpFcmpzTExkOUxBTWM2bUZMeE1XUkxucVZEbFg0RDdENFdhdm5tOFdNRk56MnVRc1dQV0ZFVktTajlCYVNtMXUwMy1KUXZzanVDWlhJMzF0VmQyekZjclR0eHphWEthb2pqaEJObUJsbHk3RnB4N3dra1FEVU8tYU9Cd1F4TUw3V094VmZRS3F4MEktNkpidUxNY0FWMmhLc3ExU083YTU4cXJBTGtZYmRtSEYwZVJHQmdEdktNaEpuR1NyOTFZMkp2U0lweEJlTVpRZWJia0RBci0wLWotZHo1Y0t6UWg4ekR1R3BYTG5VdWJDaTd2TkZaYkdvM0lJczJWcDFVd2VDTlJUX0ZsSUhlNkxxc0xnSkNDLUo0SXl5M0xUdzNyN1JQb1ZLNU1zbnpqVzM5MmptaDhTcTZJdEVyaWJGYlFHZFZ3eFlqaFpUN1otcG93LUV6X0dKU3VObnlMLUNQbGZRQl9BOUZfT0oxdmlBbDJ2M25YeVQxeGdTY0pZdTIyeTNqZHFUVHAteGk0aXRHNDhxU0dNNWRQc3JGRWhqbVlfMkhTVmx4Z0pBdWRqbHg5bEpJRzVTRTd0a3ZQTkhiaUlvOG5odERZT0hCV19GenZsUWdCamxhbUxyWG43aGxPekx0T3NqMHhTRlFkQ1lIUnhKLXM3dGRDb2RCTkNfT252bktmTzhSNjJBWkJoMlQyOUQwQzA5SE5FYWhSUXozdnVuTE9CNkNzQ0pfeDR2ZGFNWXpuc0lKWUJsc3hSR2R5U0NFVnRyNmQ1N1pFRHZZYVRuMXVmZ2RKWV91NlFnTXpHY2pkYk9lcEJjTVVpQUJaTG1MVjNtUEcwclltLTZPMXJ0aFBkSENqd0VqWmtNSkpyMkZkRHpnMDJhNVRBODQ0cG1ra0hVbWMzbGlrclgyN1UyN0dJM1ppeEhtNTBaZ0dpcnZQUVd2Qm5xb3pRSXdWN3hOZWFSZ1FlRE82ckFLUmxSM1VQU284QlJTWmFRUWVFXzlzOFdJZjdOMUtJTmhqcHRadEhUNTdXeEpmN2JMd0RFTE8wekp5TTF1TFB3SDYxMUtyeHVLcGlPdmU4TWFCbGJkckJlVHZITjdxcHZtbDZxN2UxSmtCak5XbmFIV1EwRlpFaW0xTU03T001S1gxR240R1JnSk9GUmlleGNubzlSaHJGZjRWSjVfcF9Ld01EY2wya1RhTV9kY25IbXBQQncteU5PVUpNV2ZwcFE0OEpDMHVFRjVCcWVmTGFUcTZ4OFV6dnFCT2JDdWZFWlNiT3B6M19DRHptWHlGRG1oRVNUeWMtVml3SF9sRmhvMGttNEM0bTh0SVJwU2x1a2pZOTBPZXRDUDhTUDNVbTA2M2FLUHdxaDB6U2kzM1BnbTF6a0hiVTAwa0ViQUhiNjdqdGlhNl9kc3o4a2x0ZkhHczQ2Q0lEZjU2MTJBWVMzVmc4dDRKWWc4UHk4cnFDMkh0YWFsNmVQU3pXaU1pYzE2WGd5ZEhRV1k5cm01eVVKTjJCVzFKQVdHblBsVGFUdUNDSlR2VHBibDlwX3hsZFRMQm1jekZOc09vZER4Y3hxbVlLSnJoR0tNUkNrc3otbjM2cFN1WFMwSWlQejE3TzZrWjMyMVliaTFQekdkcU9tNDJmTGxCLVZRRHJpeHJSYjZUbFVrbXB6VW9OVENxQVNJbEN5dkZSbmpGST0=)
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmQyX2hla1h3MWFmTjFjb3VLaFhKR2luV2NKZUxiT0FOVHpNWjktNURmaktFTldHOGlzdGVuUWVqY2Y0dmpvLUw4WjB6eEJMMXpkSGw0ek9reVZySkVDZ2hpcnc9PQ==)
        CM_KEY_PASSWORD: Encrypted(Z0FBQUFBQmQyX2hla1h3MWFmTjFjb3VLaFhKR2luV2NKZUxiT0FOVHpNWjktNURmaktFTldHOGlzdGVuUWVqY2Y0dmpvLUw4WjB6eEJMMXpkSGw0ek9reVZySkVDZ2hpcnc9PQ==)
        CM_KEY_ALIAS: Encrypted(Z0FBQUFBQmQyX2djZFAyenVxWS1CM25QZ01KTllNbHRaaXFfbktKMmdzM1hGTjZwejBGb0tveHZPY19NdjRHV1EzT3JXUzU0UFFLNXVEQzFLbkVXU2lnQy1hVkNHazl6LVE9PQ==)
    triggering:
      events:
        - push
    scripts:
      - |
        rm -rf ~/codemagic-build-scripts
        git clone https://github.com/NevercodeHQ/codemagic-build-scripts.git ~/codemagic-build-scripts/ --depth 1
      - echo $CM_KEYSTORE | base64 --decode > acuity.jks
      - npm install
      - |
        cd android
        ./gradlew bundleRelease
      - |
        ~/codemagic-build-scripts/android/generate-universal-apks \
          --ks $FCI_BUILD_DIR/acuity.jks \
          --ks-pass $CM_KEYSTORE_PASSWORD \
          --ks-key-alias $CM_KEY_ALIAS \
          --key-pass $CM_KEY_PASSWORD \
          --pattern 'android/app/build/outputs/bundle/release/app.aab'
    artifacts:
      - android/app/build/**/outputs/**/*.apk
      - android/app/build/**/outputs/**/*.aab
      - android/app/build/**/outputs/**/mapping.txt
  default-workflow:
    name: Default Workflow
    environment:
      vars:
        CM_KEYSTORE: Encrypted(Z0FBQUFBQmQzQUxqYkdqNElFX3BOZ2NNc3R0T1ltekM4VjlKTW1zaGNPd2oxS0JqWUkyOXpnREJ5blpOMmlYbmk0azJsQWhCb284UXdWWWdpMkdfd2drQ0x0VUJkSlVyRUFOMjUwZnZRVTlLOGhSeVphYWdCd1pLRmU2ZFZ6Z01Yb2djWTRWNkZoN04tc2VYUEc5RC1mTmxXeW1WVHJuSWYzREJzQ2FhLTgxZkt5VEJzYWk4NjJMbVZDc05yTU55LWxoV3M4QmFVaTFDSm9OMHVkdHlxNWZyT29iZnRLZ2dTY1Q0bVhIR3VRZVNLZEZQZ0trTDBxSjRfcktNdE95akt0NXhvd1RHTTZ5OXptZnpVenVUcmtUa2sxU291MWRoNXZjNUtQaS1kYTJKdHdXVURnSmRhYlJEYzFjNFVsUnN3Z3ZMOWxCWm85U3puM19uU1NNQ0IxcVZmM3RmQlpJVHhiQV9HazEteHI4YmxRSDRoWlJuSjZ2UTJJeExMQkVmOWtuZFhMbGxpZUtJS1Q4Tm12OTV4UW9pWkdIQTVhZU9XWUxVNU1XeGc3X2k1bUlZYkk0bkk0T0lEZHZFUnVMSW1Fd29LTW1tejB4aUxjNU9tLThPblBBbFl2RGo2VEJSZlROeFl0aW9hSHptVUhCNWZ3WFFuX0lsUWdBU0NyZHE2emZnV1JHODFfNENVdWU2aTdSZkZMOFZGRTVwSFZrTTVxRUVibmtOT3dOUUtaRkd0bE90dXF4aWJQT1cwWXF2OEc2cWcxX2ZGT2MyRHhZNFAyU29reDNGbEF3ZU4wYTJhX2x6NFJfcjFKLU5mT0ZnTUFNZFhKb0hvbVZCaWlONmEtdFBFZXl6OFlpTlVPVnM2eU9HczNYNWlWbkZhR2xZT1I0UWgwSlVWRnJXTk5GdUhDNVNleDJRbG5rNzhoUnZzRW5aN3dBSlJBbXpOQXNHOHNfME1vbGQ2TXZTRjNiYlk1ZW9sQ3hxbVFsR0N3UnZzWlNvUG4waUtJN0t1bE1LTDh2VU9OMzBOZmhKVEpIWDc3bzRKblZuZTU4Q285WjFyam1VeHdYQkQxVnlDbmhtVmthWE1uSmQzTmM1MmtQTl83ZHFlOWRhcVMzcE1VVmQ1SWR0eF9ONWxLZzhCUXRIZndMOHl2dDF4X2RSNDhweGRBTDFXNlhzeEMyNUNXMWpUay0wOHdHcWN3XzZXNUhWOThtdThqNnpzM2Q0d0tGWFQzR193aFFKZXlJVUJ3VnN5QW1oeXVZbkdoS2I0dWtJelR5MG56M1NOd0ZCdV82cktNT1BkeGdVOFNOcXFUckdWeWx1dzJ3RGZQWk9uckduWHVwaU5BWjV5WG9WWmNzWGRvTU5yTm1GVmw5ZGVQWHFoemotekdqUC1ZNHN5NmwwV2czSW5sTUQ3NjRjVWZ6WEpWajZRWDFLOFhmam81YVlweU4xekd3cmR2c3IzX0cwM3VFWkxtbnNpWU9KSkhJcjVydExBUnBlVVVIT0hxSWxuTEVaVjQ1WmRLSXBUREdpeFpZV3FzRThXcXFWN3Y5Y2dkQk04MXEyODFCN3RrcEdQVUdRYV9ZVm90UjJQN1lxaFlUeHZNTWNxZ19ocGczNzZQTDBSQjBpdEt2LUd2WXVWbm9DS0x6N185X1VTMkUyMjdreUhjaDVsRGNsMXBlVWhEZkQ3aDhNTm9nU2ZpZ09sVFVNSkdkRzBTQklodFpPdTZzOHFDZHhESGxidEFyYVdMeGJoaWY1U2gyaUZmem5VeHo5SERlRm5jcWl1Q2dydXRIblFPekd5RnpfcDdST25WelliVjE4dFhPMjZNZ09kbW5nRjJsQ2V2QXZzdHIyOHl6a3M0THZTeEcwTHBzbmhnZ2ZzemZFaXRXenVrZ2lVOVRTSzRFZkx0MG9ySVNmU2Qwd282NkQyeU5wU3gtZzE2cG9McWtTWncxTTEzOGdNQkZVQ3Y1ZlVxTFUtNTZhU2VHN2g4Y0Q2QW1hcWVlczRsNE0zX1VMZUtEcVU4cTlkVGNCZ3lLLUZqLWsyelhvSzEwRm1PeThteW8xUGZQVU1MOWNmN2IwUW1PODB3b2cyVVlUMUtsRmJ0d3U2ZGJMaF9BOGpjdlVPQ3lvUVY0SE92dUJnc1U3MzNNU09sc0o5QS1yRVlocExEZkxoeVJwNEROUG1jTG1oMGdkck5CVGkxZFdWa256VWc1LVJrdWFfSm1iTXF5RFgtejJkWENsR3VJTktOZXdTY2lKSThORjVNUVY3Yk5OdUplMHpOWWdkSGUwNHZIX1pNWXh3Y3hwRm9BVUlJOUNBa0tZUTl5WDRjaXowbU5rVU9ETXVvQUxISEhrUm5aVGFUNGtxVkI0bmFEcTk0SXVpc3J1OGFOaFJHc3N4QnFDelRsek41cEswU2w1QXVqcjk2UGpCUVdUcklyWS0yODBwMGhRNlhGX1g0Q09ta3VQWGU1bHJra09GLUktZ3B1eTcwMEZRS3RYVmlNNGwwR3FBcDA1TmFPS2hMaDBQQmQ4aUVqcHR3cU5IdjMtd0ViTlZnQkJxdm10TEE2V2RrY29DQ3pOaExVdy1TNVFTdDYyS3pHWlVVM192dnFoaGo3UTNQWDFQRWl5OUxFNEJQOHRTU2hic3Vwc0g3eDJaemx4c0dWdzcyaHAtZk40ZzJZcmd4ODNKUG93aFprcXhyZnI2Q3hESnV0cFNfZ0JoRHJKNXhDMmlwSVFNcEJnUWd2OFF6VzZLcTZMUktXVjl5cTBXSGVOX1Nrb3lBbHczeTRDUmhxcnpucHdUd3RRQkozUDBvdWhiazNjY3hYblhMbjlBSG9zbGhPeTk5bkdmdHV6U3QzcWk4ZE5LVmtqU3FVVmVYNHpqOC04bmZieEE2bnpKc2M4aElDWlhnTUlzSTI0cC1oWmJucG5Nc0hfeWVWaF9rMUY2b2J5R0dWM1FSbjZPb3p6azZ6TDN2SEpEcEUwUUliUkRIUHc3TmZNU29fLUxMNXR4dkI4Zkxyd0x4WEtwc1ZqWGxaSXJpcFNvU1FUXzNHakFpc0N0dGIyMlVibXFpSHdvMGUyZy1NRFp4WU9RS2dDWFFNYUVicGhJUFBueC1FV1IyUWJjOGpzdVc2ek5UWFBQcG9fQ3pBTml6ZVVscTMydHhHUEdDdy1mbHFOTGRfazNxV2FfbG4wRUxYckRXX2xBX2VMN0lsbkI3VF9vYzBlR21IWlhSTXA0Tm9IbUJvemJ3OGJNMFcxU3RfQUFtbmhPeWpYaUZiQ3F3ck9MMGgzSE5ZNDloRS11UE5PMmluTkZOeWxxS2JPNV82U1BxYy1SVjUtVzJRZjRHMHV5aFA2Rkp1el9oTUkzbHg2MndrUU9IZmRFc3ZRTWFqOWdsWjVGanNQM2JWeG1ZM1JsT1ZLMEZQa0NCdFdub2F4YW1MNDQ5Z3lkc0ZiQmtsRTZHZ0thRXNXQ0t1TWU4VmRRUHo1RkJpNWYyQ21WZG84aFFrVklFbzkzNldfVUszQ1F5MHVsMmRxbXlab01XcjM5VzVlN2FzV3A3UUFndUdQMXZXR1YwNGR4ajRNSmd4UDV5NHFvTmV1TVJPTDBvRWo5VzdyT25sODRpVzU4anNtZHJHWVVtdS1QMERuV0ZpZWhvQjJfdzJNR2h2T1FYVDZUd1ZENC10SW5mMzFiMkFMX3JNWURGeHgzUTB3OXhObEh5dzQzeXBOVkNuRU1oT2o2YTBwZGtsQ0lBLTRaZzlmaVUxWGVmUW5nR1REbmVwT28wQmp0R3ZWekU4cERxT3VuSWZQbEFzT0o4VTNuMUpFdFRYUE42QVpJeHZ3VDRReC1lREw5SUxpMUVuMHNRMVA2Nkt6T1ZDeEFlVHpDcFd5R01zY1dkdVhJZVotNDNNWERVSjA2dDlldVNONm9rMWRwZzV0N0tJSFJJWnNUOXE0OHdTR2N1dVZCTHE5OV9uc0N6d2d4Z3AzUzVxRW42UHV3Z3VKYTAyZ2ZGVFpIclUzWEdwUDJONXlJVWZfMHR0bUhuTXVHT29CcEh5R1hsRVhlT05IcWFPYzFoRUxVNERlaV92Q3dfZkxNa0VDSzVpclZkUXhLYlcxYXYxVkxOT1EtcmN2QmN2ZTFiX3RUdjRkRzlhZVpZTHBEQ0s0MlhOakl5M2tUcHM4NWE4LWc4Tm1LNFlqd0V2Tkw5VVVWWEtPMDI0TFRhNFF0aVBXelBIS0JnNUpYWVVrb29lWWF6RXpZZi1LbjVKSXdXT0lGUnN1LW9nTnpJTk1iZlEyV1RfN1JBWjBkWjJkTnpTTWR6cG1OZ0NKemk1Q1lialE5ejNZeUhaZHNOT2U3MFlmanZ1VXp5TWJwWm9pTTFVVnNpOG1qUXZab3R4TUlHZ3pFdnZXWlFqOGRfUGE1MVNEc2s5dktPem5Qem1Fdi0wbVZZUXdKNHpXcjcxdkx2Qlp2QWJCSDh3OFpFemNULXlGclBMRGtMZ2lMbGstNzc0MFliX3dkSDdGWkc1QnJqQ3VVel9oRkdqRm9LcUdWNDBVbTBtLWtUT19rZnh6S1VMX3M4Qk5IZDJJOGdTc19RQXZOaHpLbEZVblMzOWNZWGdMLWNCbHo1R2p3dXRVRW9VcmFuZXNydXBRdnFDcTBWQnZFTUZsenM3dFMzVnlhNFRBWV93c3QtbHhta1l3TDd1ZGh1OW1qcUdzajdoeUlhaW1RdDhpWk5aQjczcExsdVZabDBjeU9keXNiOFYyT3o2RnlQVFR1RUxKaWRvaW1va1QtZTNvanNkOHdUQkM5R3pIbVBpU25rMGpiZnZSU2hHQkE1YWNCUzNVTjBiTFc2UGRSTUczUkxtazA1VW1DdDREeXRkNVVQSHZ1Vk1mOUdlNmg2SHJqcjhmLVktQzEtX1FQZ2JhT1ZEYld1VzRNRWpCMkd6VHF1cGlBdFhYUU0ySTVEY2M0bDQwa29BcG1wTTBmVThiTjd2cVljVzBMaElFLTRmdGd0RzM2OG1sUmVmbGY3SF9iUU5ILVF6cWdrZV9lRUkybWZaQ2ZwbGc0clpUNnhUano5ODlTYWtFMERlMVJjOWVjdzVnUmFxbnF2RXc3NnlPaS1OVFk0RHhEUGxEb0U0aDlwUXA0QXFHMW5oQWJFZDB3Z21DSENSV1lDOC14MlFtRnVfTHlmRmhiSWZFTWZqNFgtcHpqVEtMRmZfZFV2UWlTb29JTHJRUXNFZWFvbktuNjBGRXAza3JaOXZuWUJLcG1wMXFEbk1oQ1lmaTJ0ZmhacFNfWjZ2VkdfU3VkajItZXBwSGdycHZ6WVlRV3NHR2ItQmVEUTF4cGVndDF4aWszR3hMVGVTX21HQzJTZXBob1ZVcnF1Wjc2TE9iUzQwdjJYYVNCQ29fRjhwbkZzRDYyN1BKOXlxWnU1eTNLQUdVWVZsOXhWODlJMkZDOFBCeUtWcmlmMF9sY2VHLUVrQT0=)
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmQzQUxqamgxQU5RZm82OG1xbTF6X0ttRzdYQ19MWXhGalJycW5OT2lJWTdSNEd3WnVQQzlweDM5YzY2SUVPRThPaVprRnlDaVVJWlUzcDZMVkVndHppS0VoVnc9PQ==)
        CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmQzQUxqUXZ4X0dyZVZCbmZMWG5lZzQ1WGNQMGhyRHF5YkhVSUhWMVNJZS1SMThOWlp3dHdYM2Y3bnhjaHczY3E5VU5DVm1hNnE0QmExWlMzVWJnZVlPemFRUkE9PQ==)
        CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmQzQUxqRmJTdHVlbXJ6Q2Y3dXlIcHl4VTAwcnJtVHlLZXlnU0t4NnVaX1ZvZGtyWW82YUhpWVlkZHZqVTYxNFlocmJ5T3J1MXpZcW8wcTRYelRENDQ5LUVTZnc9PQ==)
      flutter: stable
    scripts:
      - |
        # fetch codemagic helper scripts
        rm -rf ~/codemagic-build-scripts
        git clone https://github.com/NevercodeHQ/codemagic-build-scripts.git ~/codemagic-build-scripts/ --depth 1
      - |
        # set up key.properties
        echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<'EOF'
        storePassword=$CM_KEYSTORE_PASSWORD
        keyPassword=$CM_KEY_ALIAS_PASSWORD
        keyAlias=$CM_KEY_ALIAS_USERNAME
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - flutter build appbundle --debug
      - |
        # generate signed universal apk with user specified keys
        ~/codemagic-build-scripts/android/generate-universal-apks \
          --ks /tmp/keystore.keystore \
          --ks-pass $CM_KEYSTORE_PASSWORD \
          --ks-key-alias $CM_KEY_ALIAS_USERNAME \
          --key-pass $CM_KEY_ALIAS_PASSWORD \
          --pattern 'build/**/outputs/**/*.aab'
    artifacts:
      - build/**/outputs/**/*.apk
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - bondarenko.stanislav.96@gmail.com
